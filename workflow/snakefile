YEARS = ["2022", "2023"]

rule all:
    input:
        expand("data/processed/final_records_{year}.csv", year=YEARS),

        expand("data/processed/final_records_{year}.json", year=YEARS),

        expand("reports/validation_results/initial_validation_output_{year}.txt", year=YEARS),

        expand("reports/validation_results/final_validation_output_{year}.txt", year=YEARS)

rule initial_validation:
    input:
        "data/raw/records_{year}.csv"
    output:
        "reports/validation_results/initial_validation_output_{year}.txt"
    shell:
        "python src/Validation/validate.py {input} {output}"

rule normalization:
    input:
        "data/raw/records_{year}.csv"
    output:
        "data/interim/normalized_records_{year}.csv"
    shell:
        "python src/Cleaning/normalization.py {input} {output}"

rule impute_data:
    input:
        "data/interim/normalized_records_{year}.csv"
    output:
        "data/interim/imputated_records_{year}.csv"
    shell:
        "python src/Cleaning/imputation.py {input} {output}"

rule finalize_data:
    input:
        "data/interim/imputated_records_{year}.csv"
    output:
        "data/processed/final_records_{year}.csv",
        "data/processed/final_records_{year}.json"
    shell:
        "python src/Cleaning/deduplication.py {input} {output}"

rule final_validationx:
    input:
        "data/processed/final_records_{year}.csv"
    output:
        "reports/validation_results/final_validation_output_{year}.txt"
    shell:
        "python src/Validation/validate.py {input} {output}"